-- 코드를 입력하세요
SELECT MONTH(A.START_DATE) AS MONTH, A.CAR_ID , COUNT(*) AS RECORDS FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY A JOIN (SELECT *, COUNT(*) AS COUNT FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY WHERE YEAR(START_DATE)=2022 AND MONTH(START_DATE)>7 AND MONTH(START_DATE)<11 GROUP BY CAR_ID HAVING COUNT > 4) B ON A.CAR_ID=B.CAR_ID WHERE YEAR(A.START_DATE)=2022 AND MONTH(A.START_DATE)>7 AND MONTH(A.START_DATE)<11 GROUP BY A.CAR_ID,MONTH ORDER BY MONTH ASC,A.CAR_ID DESC;