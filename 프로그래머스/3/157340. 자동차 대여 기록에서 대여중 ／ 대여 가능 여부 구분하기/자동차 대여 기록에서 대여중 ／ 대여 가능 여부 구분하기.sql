-- 코드를 입력하세요
SELECT B.CAR_ID, IF(B.AVAILABILITY_SUM>0,"대여중","대여 가능") AS AVAILABILITY FROM (SELECT A.CAR_ID, SUM(A.AVAILABILITY_NUM) AS AVAILABILITY_SUM FROM (SELECT CAR_ID, IF(START_DATE <= '2022-10-16' AND '2022-10-16' <= END_DATE , 1, 0) AS AVAILABILITY_NUM FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY) A GROUP BY A.CAR_ID) B ORDER BY B.CAR_ID DESC;